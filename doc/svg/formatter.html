<html lang="en">
<head>
    <title>SVG Viewer</title>
    <meta charset="UTF-8">
    <style>
        body {
            padding: 20px;
            background-color: #ffffff; /* Dark background for contrast */
        }

        .svg-container {
            width: 100%; /* Fills screen width */
            margin: 0 auto; /* Centers it */
        }

        svg {
            display: block;
            width: 100%;
            height: auto; /* Maintains aspect ratio */
        }
    </style>
    <script>
        // read svg.html and insert its content into the svg-container div
        fetch('svg.html')
            .then(response => response.text())
            .then(data => {
                document.querySelector('.svg-container').innerHTML = data;

                const svg = document.querySelector('svg');

                svg.querySelectorAll('text').forEach(el => {
                    el.setAttribute('font-family', 'Roboto, sans-serif');
                    el.setAttribute('fill', '#666666');
                });

                svg.querySelectorAll('g.graph polygon').forEach(el => {
                    el.setAttribute('stroke', 'none');
                    el.setAttribute('fill', 'none');
                });

                svg.querySelectorAll('g.cluster ellipse, g.cluster path').forEach(el => {
                    el.setAttribute('stroke', '#666666');
                    el.setAttribute('fill', 'none');
                });

                svg.querySelectorAll('g.edge path').forEach(el => {
                    el.setAttribute('stroke', '#666666');
                    el.setAttribute('fill', 'none');
                });

                svg.querySelectorAll('g.edge polygon').forEach(el => {
                    el.setAttribute('stroke', '#666666');
                    el.setAttribute('fill', '#666666');
                });

                svg.querySelectorAll('g.node').forEach(el => {
                    const text = el.querySelector('text');
                    const shape = el.querySelector('ellipse, path');
                    if (!text || !shape) return;
                    if (text.textContent.includes('ðŸ¤–')) {
                        shape.setAttribute('stroke', 'green');
                        shape.setAttribute('fill', 'lightgreen');
                    } else if (text.textContent.includes('ðŸ”§')) {
                        shape.setAttribute('stroke', 'blue');
                        shape.setAttribute('fill', 'lightblue');
                    } else {
                        shape.setAttribute('stroke', '#666666');
                        shape.setAttribute('fill', '#cccccc');
                    }
                });
            });
    </script>
</head>
<body>

<div class="svg-container">
</div>

<button id="downloadBtn">Download SVG</button>

<script>
    function downloadSvg(svgElement, filename = 'diagram.svg') {
        // Clone the SVG so we donâ€™t modify the live DOM
        const svgClone = svgElement.cloneNode(true);

        // Ensure SVG namespace
        svgClone.setAttribute('xmlns', 'http://www.w3.org/2000/svg');

        // Serialize SVG to string
        const serializer = new XMLSerializer();
        const svgString = serializer.serializeToString(svgClone);

        // Create a Blob and trigger download
        const blob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
    }

    // Button click triggers download
    document.getElementById('downloadBtn').addEventListener('click', () => {
        const svg = document.getElementsByTagName('svg')[0];
        downloadSvg(svg, 'diagram.svg');
    });
</script>
</body>
</html>